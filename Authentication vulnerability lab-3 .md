# 🔐 Password Reset Broken Logic - Exploitation Guide

**📅 Last Edited:** March 19, 2025  
**✍️ Author:** Ankur Sharma  

## 🎯 Objective
The purpose of this lab is to identify and exploit a vulnerability in the password reset functionality. By leveraging this flaw, we will reset Carlos’s password and gain unauthorized access to his **"My Account"** page.

---

## 🔑 Lab Credentials
- **👤 Your Credentials:** `wiener:peter`
- **🎯 Victim's Username:** `carlos`

---

## 🚀 Step-by-Step Exploitation

### 1️⃣ Identifying the Vulnerability ⚠️
The password reset mechanism in this application is flawed due to:
- **❌ Lack of proper identity verification**, allowing unauthorized password resets.
- **🔓 Absence of token validation** or a secure authentication mechanism, making it susceptible to manipulation.

### 2️⃣ Initiating the Password Reset Process 🔄
1. Navigate to the **🔑 Login Panel** and locate the **Forgot Password** functionality.
2. Enter the username `wiener` and request a password reset.
3. This triggers an email containing a **🔗 password reset link**.

### 3️⃣ Capturing the Password Reset Request 🎯
To manipulate the request, use **Burp Suite**:
- 🛑 **Intercept** the request when submitting the password reset form.
- 🔍 Locate the reset request in **HTTP history** under the **Proxy** tab.
- 📤 Send the captured request to **Repeater** for modification.

### 4️⃣ Modifying the Request to Target Carlos 🎭
- Within the intercepted request, identify the **username parameter** (`wiener`).
- ✏️ Change `wiener` to `carlos` to attempt resetting Carlos’s password.
- 🏆 If the application does not verify email ownership, it will accept the modified request.

### 5️⃣ Sending the Manipulated Request 📡
- 📩 Forward the **modified request** to the server.
- ✅ If successful, you will receive a response confirming that **Carlos's password has been reset**.

### 6️⃣ Logging in as Carlos 🔓
- Return to the **🔑 Login Page** and enter:
  - **👤 Username:** `carlos`
  - **🔑 New Password:** *(the password set in the manipulated request)*
- 🎉 Upon successful login, navigate to the **"My Account"** page to confirm the exploit worked.

---

## 🔍 Security Implications 🚨
This vulnerability arises due to **insufficient authentication checks** during the password reset process. A secure implementation should:
- 🛡 **Require a unique, time-sensitive token** for password resets.
- 📧 **Ensure the token is tied to the correct user** and verify it via email confirmation.
- 🔒 **Restrict password resets** to only valid email recipients.

## 🏁 Conclusion
By exploiting broken logic in the password reset mechanism, we were able to reset Carlos’s password and gain unauthorized access to his account. This highlights a **critical security flaw in authentication workflows** that could be exploited by malicious actors if not properly mitigated.

---

## 🔧 Recommendations for Fixing This Vulnerability ✅
To prevent such attacks, applications should implement **robust password reset mechanisms**, including:
- 🔐 **Multi-Factor Authentication (MFA):** Require additional verification (e.g., OTP via email/SMS).
- 🔑 **Strong Token Validation:** Ensure password reset links are single-use, time-limited, and associated with the correct email.
- 📊 **Logging and Monitoring:** Implement monitoring to detect abnormal password reset requests.
- 📩 **User Notifications:** Send alerts when password reset attempts are made.

By addressing these issues, organizations can significantly **reduce the risk of unauthorized account takeovers** and **improve security** in authentication workflows. 🔒🚀

![1 1](https://github.com/user-attachments/assets/8f131665-4474-4fc5-a236-6eebd1228fd5)
![1 2](https://github.com/user-attachments/assets/2ab489bb-5b46-4a98-af58-1d0fb2f57845)
![1 3](https://github.com/user-attachments/assets/699f0e70-1c46-4705-8ca5-0f6bdf9cd644)
<img width="468" alt="1 4" src="https://github.com/user-attachments/assets/ecdd51d9-6a4f-4821-b832-262e777c1cf9" />
![1 5](https://github.com/user-attachments/assets/ff389df3-dee0-4687-b627-24fded9cd8ff)
![1 6](https://github.com/user-attachments/assets/4ff54fd0-5311-4ed2-ac26-4ac9c604bfa7)

